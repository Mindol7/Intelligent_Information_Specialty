# Forensic Detection of Timestamp Manipulation for Digital Forensic Investigation
- 발표일: 2024.11.11  
- 발표자: Min–hyuk Cho, Mobile Systems Engineering

## 개요
이 프로젝트는 **NTFS 파일 시스템에서 발생하는 타임스탬프 조작을 효과적으로 탐지하기 위한 알고리즘**을 제안하고, 이를 기반으로 구현된 도구의 성능을 다양한 시나리오에서 검증한 연구를 바탕으로 합니다.  
디지털 포렌식 조사에서 파일의 생성·수정·접근 시간 정보는 중요한 증거가 되지만, 공격자는 이를 조작하여 분석을 방해할 수 있습니다. 본 연구에서는 `$LogFile` 및 `$UsnJrnl` 로그를 활용하여 조작 여부를 정밀하게 판별하는 방법을 제시합니다.

---

## 목차
1. [배경](#배경)
2. [탐지 알고리즘](#탐지-알고리즘)
3. [구현](#구현)
4. [평가](#평가)
5. [결론](#결론)
6. [참고](#참고)

---

## 배경
- **디지털 포렌식**: 데이터의 무결성을 보존하고, 과학적 절차로 수집·분석·보고하는 과정 (NIST SP 800-86).
- **안티 포렌식**: 데이터를 은폐하거나 변경하여 분석을 방해하는 행위.
- **타임스탬프**: 로그 생성 시각 정보를 담으며, 사건 재구성의 핵심 단서.
- **NTFS의 시간 속성**  
  - M (Modified): 파일 내용이 마지막으로 수정된 시간  
  - A (Accessed): 마지막 접근 시간  
  - C (Created): 생성된 시간  
  - E (Entry Modified): MFT 엔트리 수정 시간  
- **관련 메타데이터 구조**
  - `$STANDARD_INFORMATION`
  - `$FILE_NAME`
  - `$LogFile`
  - `$UsnJrnl`

---

## 탐지 알고리즘
본 연구에서는 `$LogFile` 기반과 `$UsnJrnl` 기반의 **두 가지 탐지 기법**을 제안합니다.

### 1. `$LogFile` 기반
1. 타임스탬프 변경 이벤트를 로그에서 추출
2. 변경이 단순 수정인지, 조작인지 판별  
   - 이전·이후 생성·수정 시간 비교  
   - 나노초 값이 `0`인 경우 조작 가능성 높음
3. 파일 시스템 터널링 여부 확인  
   - 3가지 실험: 삭제 후 재생성, 이름 변경 후 복원, 경로 변경 후 복원

### 2. `$UsnJrnl` 기반
1. 기본 탐지 패턴(BASIC_INFO_CHANGE → CLOSE)을 1초 내에 수행한 파일 수집
2. 생성 이벤트 여부에 따라 `$SI-E` 값과 시간 차이 분석
3. 터널링 여부 확인 (동일한 3가지 실험 적용)

---

## 구현
- **도구명**: NTFS log tracker v1.9
- **기능**
  - `$LogFile` 및 `$UsnJrnl` 로그 파싱
  - 의심 이벤트 추출 및 상세 분석
  - GUI 기반 탐지 결과 표시


---

## 평가
- **데이터셋 구성**: 12개의 테스트 케이스  
(나노초 값 초기화, `$FN` 조작, `$SI`/`$FN` 동시 조작, 터널링 시나리오 등)
- **비교 대상**
- Program A, Program B (기존 도구)
- NTFS Log Tracker v1.9 (`$LogFile` 모드, `$UsnJrnl` 모드)
- **결과**
- 대부분의 조작 시나리오에서 탐지 성공
- 기존 도구 대비 오탐(FP) 감소

---

## 결론
- **NTFS 환경에서의 파일 타임스탬프 조작 탐지 알고리즘** 제안 및 도구 구현
- 다양한 시나리오에서 성능 검증 완료
- 디지털 포렌식 조사 시, 타임스탬프 조작 여부를 보다 정확하게 판별 가능

---

## 참고
- IEEE Access, DOI: [10.1109/ACCESS.2024.3395644](https://doi.org/10.1109/ACCESS.2024.3395644)